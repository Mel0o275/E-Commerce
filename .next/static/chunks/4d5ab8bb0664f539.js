(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,74022,e=>{"use strict";e.s(["default",()=>p],74022);var t=e.i(43476),s=e.i(81307);let o=s.z.object({email:s.z.email("Email is required").nonempty("Email is required")});var r=e.i(94814),a=e.i(53145),n=e.i(71645),i=e.i(93479),l=e.i(3133);async function c(e){let t=await fetch("https://ecommerce.routemisr.com/api/v1/auth/forgotPasswords",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})}),s=await t.json();return console.log(s),s}var d=e.i(46696);async function u(e){let t=await fetch("https://ecommerce.routemisr.com/api/v1/auth/verifyResetCode",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({resetCode:e})}),s=await t.json();return console.log(s),s}async function m(e,t){let s=await fetch("https://ecommerce.routemisr.com/api/v1/auth/resetPassword",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,newPassword:t})}),o=await s.json();return console.log(o),o}function p(){let[e,s]=(0,n.useState)(!1),[p,h]=(0,n.useState)(!1),[g,x]=(0,n.useState)(""),[b,y]=(0,n.useState)(""),[f,j]=(0,n.useState)(""),[w,v]=(0,n.useState)(""),[N,C]=(0,n.useState)(!1),S=(0,a.useForm)({defaultValues:{email:""},resolver:(0,r.zodResolver)(o)});async function P(e){C(!0);try{let t=await c(e.email);"success"===t.statusMsg?(d.toast.success("Reset link sent to your email",{position:"top-center",duration:2e3}),j(e.email),s(!0),S.reset()):d.toast.error(t.message||"Error sending reset link",{position:"top-center",duration:2e3})}catch(e){console.log("Error calling forgetPass API:",e)}C(!1)}async function E(){try{let e=await u(g);"Success"===e.status?(d.toast.success("Code verified successfully",{position:"top-center"}),x(""),s(!1),h(!0)):d.toast.error(e.message||"Invalid code",{position:"top-center"})}catch(e){d.toast.error("Error verifying code",{position:"top-center"})}}async function k(){try{let e=await m(f,w);console.log(e),e.token?(d.toast.success("Password reset successfully",{position:"top-center"}),h(!1),v(""),y(""),window.location.href="/login"):(console.log(e),d.toast.error(e.message||"Failed to reset password",{position:"top-center"}))}catch(e){d.toast.error("Error resetting password",{position:"top-center"})}}return(0,t.jsxs)("div",{className:"w-full sm:w-2/3 md:w-1/2 lg:w-1/3 mx-auto mt-12 px-4",children:[(0,t.jsx)(l.Form,{...S,children:(0,t.jsxs)("form",{onSubmit:S.handleSubmit(P),className:"space-y-4",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-center text-blue-500",children:"Forgot Password"}),(0,t.jsx)(l.FormField,{control:S.control,name:"email",render:e=>{let{field:s}=e;return(0,t.jsxs)(l.FormItem,{children:[(0,t.jsx)(l.FormLabel,{children:"Email"}),(0,t.jsx)(l.FormControl,{children:(0,t.jsx)(i.Input,{placeholder:"Enter your email",...s,className:"focus:ring-1 focus:!ring-blue-300",type:"email"})}),(0,t.jsx)(l.FormDescription,{}),(0,t.jsx)(l.FormMessage,{})]})}}),(0,t.jsx)("button",{onClick:k,className:"disabled:cursor-not-allowed mt-5 w-full cursor-pointer bg-blue-500 hover:bg-blue-600 duration-100 text-white py-2 rounded",disabled:N,children:"Send Reset Link"})]})}),e&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg p-6 w-96 shadow-lg",children:[(0,t.jsx)("h2",{className:"text-xl font-bold mb-4 text-center",children:"Enter Reset Code"}),(0,t.jsx)(i.Input,{placeholder:"Enter your reset code",value:g,onChange:e=>x(e.target.value),className:"mb-4"}),(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)("button",{onClick:()=>{s(!1),x("")},className:"cursor-pointer px-4 py-2 bg-gray-300 rounded hover:bg-gray-400",children:"Cancel"}),(0,t.jsx)("button",{onClick:E,className:"cursor-pointer px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Verify"})]})]})}),p&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg p-6 w-96 shadow-lg",children:[(0,t.jsx)("h2",{className:"text-xl font-bold mb-4 text-center",children:"Reset Your Password"}),(0,t.jsx)(i.Input,{placeholder:"Enter your email",type:"email",value:f,onChange:e=>j(e.target.value),className:"mb-4"}),(0,t.jsx)(i.Input,{placeholder:"Enter new password",type:"password",value:w,onChange:e=>v(e.target.value),className:"mb-4"}),(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)("button",{onClick:()=>{h(!1),j(""),v("")},className:"cursor-pointer px-4 py-2 bg-gray-300 rounded hover:bg-gray-400",children:"Cancel"}),(0,t.jsx)("button",{onClick:k,className:"cursor-pointer px-4 py-2 bg-blue-500 text-white rounded hover:bg-green-600",children:"Reset Password"})]})]})})]})}}]);